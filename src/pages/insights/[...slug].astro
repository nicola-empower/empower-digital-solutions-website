---
import { getCollection } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import { ArrowLeft, Calendar, Tag, User } from "lucide-react";

export const prerender = true;

export async function getStaticPaths() {
	const posts = await getCollection("insights");
	return posts.map((post) => ({
		params: { slug: post.slug },
		props: { post },
	}));
}

const { post } = Astro.props;
const { Content } = await post.render();

const formatDate = (date: Date) => {
	return new Date(date).toLocaleDateString("en-GB", {
		day: "numeric",
		month: "long",
		year: "numeric",
	});
};
---

<Layout title={`${post.data.title} | Empower Digital Solutions`}>
	<main
		class="pt-32 pb-20 px-4 md:px-6 bg-white dark:bg-slate-950 min-h-screen"
	>
		{/* Progress Bar (Optional, can add later) */}

		<article class="max-w-3xl mx-auto">
			{/* Back Link */}
			<a
				href="/insights"
				class="inline-flex items-center text-sm font-bold text-slate-500 hover:text-empower-pink transition-colors mb-8 group"
			>
				<ArrowLeft
					className="w-4 h-4 mr-2 group-hover:-translate-x-1 transition-transform"
				/>
				Back to Insights
			</a>

			{/* Header */}
			<header class="mb-12">
				<div
					class="flex flex-wrap items-center gap-4 text-sm text-slate-500 dark:text-slate-400 mb-6 font-medium"
				>
					<div class="flex items-center gap-2">
						<Calendar className="w-4 h-4" />
						{formatDate(post.data.pubDate)}
					</div>
					<div class="w-1 h-1 bg-slate-300 rounded-full"></div>
					<div class="flex items-center gap-2">
						<User className="w-4 h-4" />
						{post.data.author}
					</div>
					{
						post.data.tags && (
							<>
								<div class="w-1 h-1 bg-slate-300 rounded-full" />
								<div class="flex items-center gap-2 text-empower-pink">
									<Tag className="w-4 h-4" />
									{post.data.tags.join(", ")}
								</div>
							</>
						)
					}
				</div>

				<h1
					class="text-3xl md:text-5xl font-black text-slate-900 dark:text-white leading-tight mb-6"
				>
					{post.data.title}
				</h1>

				<p
					class="text-xl text-slate-600 dark:text-slate-300 leading-relaxed border-l-4 border-empower-pink pl-6 italic"
				>
					{post.data.description}
				</p>
			</header>

			{/* Content */}
			<div
				class="prose prose-lg prose-slate dark:prose-invert max-w-none
                prose-headings:font-bold prose-headings:text-slate-900 dark:prose-headings:text-white
                prose-p:text-slate-600 dark:prose-p:text-slate-300
                prose-li:text-slate-600 dark:prose-li:text-slate-300
                prose-strong:text-slate-900 dark:prose-strong:text-white
                prose-a:text-empower-pink prose-a:no-underline hover:prose-a:underline
                prose-img:rounded-2xl prose-img:shadow-xl"
			>
				<Content />
			</div>

			{/* CTA */}
			<div
				class="mt-20 p-8 md:p-12 bg-slate-900 rounded-3xl text-center relative overflow-hidden"
			>
				<div
					class="absolute top-0 right-0 w-64 h-64 bg-empower-pink/20 rounded-full blur-3xl -mr-16 -mt-16 pointer-events-none"
				>
				</div>
				<div
					class="absolute bottom-0 left-0 w-64 h-64 bg-purple-600/20 rounded-full blur-3xl -ml-16 -mb-16 pointer-events-none"
				>
				</div>

				<h3
					class="text-2xl md:text-3xl font-bold text-white mb-4 relative z-10"
				>
					Ready to build your Digital Engine?
				</h3>
				<p class="text-slate-400 mb-8 max-w-xl mx-auto relative z-10">
					Stop letting your website be a brochure. Let's turn it into
					a revenue-generating asset.
				</p>
				<a
					href="/contact"
					class="relative z-10 inline-block bg-white text-slate-900 font-bold py-4 px-8 rounded-xl hover:bg-empower-pink hover:text-white transition-all transform hover:-translate-y-1 shadow-lg"
				>
					Book a Strategy Call
				</a>
			</div>
		</article>
	</main>
</Layout>

<style is:global>
	/* Force dark mode text colors for insights content to override any prose defaults */
	.dark .prose p,
	.dark .prose li,
	.dark .prose ul,
	.dark .prose ol {
		color: #cbd5e1 !important; /* slate-300 */
	}
	.dark .prose strong,
	.dark .prose h1,
	.dark .prose h2,
	.dark .prose h3,
	.dark .prose h4 {
		color: #ffffff !important;
	}
</style>
