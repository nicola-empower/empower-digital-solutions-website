---
import { getCollection } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import { ArrowLeft, Calendar, Tag, User } from "lucide-react";

export const prerender = true;

export async function getStaticPaths() {
	const posts = await getCollection("insights");
	return posts.map((post) => ({
		params: { slug: post.slug },
		props: { post },
	}));
}

const { post } = Astro.props;
const { Content } = await post.render();

const formatDate = (date: Date) => {
	return new Date(date).toLocaleDateString("en-GB", {
		day: "numeric",
		month: "long",
		year: "numeric",
	});
};
---

<Layout
	title={`${post.data.title} | Empower Digital Solutions`}
	description={post.data.description}
	image={post.data.image}
>
	<main
		class="pt-32 pb-20 px-4 md:px-6 bg-white dark:bg-slate-950 min-h-screen"
	>
		{/* Progress Bar (Optional, can add later) */}

		<article class="max-w-3xl mx-auto">
			{/* Back Link */}
			<a
				href="/insights"
				class="inline-flex items-center text-sm font-bold text-slate-500 hover:text-empower-pink transition-colors mb-8 group"
			>
				<ArrowLeft
					className="w-4 h-4 mr-2 group-hover:-translate-x-1 transition-transform"
				/>
				Back to Insights
			</a>

			{/* Header */}
			<header class="mb-12">
				<div
					class="flex flex-wrap items-center gap-4 text-sm text-slate-500 dark:text-slate-400 mb-6 font-medium"
				>
					<div class="flex items-center gap-2">
						<Calendar className="w-4 h-4" />
						{formatDate(post.data.pubDate)}
					</div>
					<div class="w-1 h-1 bg-slate-300 rounded-full"></div>
					<div class="flex items-center gap-2">
						<User className="w-4 h-4" />
						{post.data.author}
					</div>
					{
						post.data.tags && (
							<>
								<div class="w-1 h-1 bg-slate-300 rounded-full" />
								<div class="flex items-center gap-2 text-empower-pink">
									<Tag className="w-4 h-4" />
									{post.data.tags.join(", ")}
								</div>
							</>
						)
					}
				</div>

				<h1
					class="text-3xl md:text-5xl font-black text-slate-900 dark:text-white leading-tight mb-6"
				>
					{post.data.title}
				</h1>

				<p
					class="text-xl text-slate-600 dark:text-slate-300 leading-relaxed border-l-4 border-empower-pink pl-6 italic"
				>
					{post.data.description}
				</p>
			</header>

			{/* Content */}
			<div
				class="prose prose-lg prose-slate dark:prose-invert max-w-none
                prose-headings:font-bold prose-headings:text-slate-900 dark:prose-headings:text-white
                prose-p:text-slate-600 dark:prose-p:text-slate-300
                prose-li:text-slate-600 dark:prose-li:text-slate-300
                prose-strong:text-slate-900 dark:prose-strong:text-white
                prose-a:text-empower-pink prose-a:no-underline hover:prose-a:underline
                prose-img:rounded-2xl prose-img:shadow-xl"
			>
				<Content />
			</div>

			{/* Google Follow Button */}
			<div class="my-12 flex justify-center">
				<a
					href="https://www.google.com/preferences/source?q=empowerdigitalsolutions.co.uk"
					target="_blank"
					rel="noopener noreferrer"
					class="inline-flex items-center gap-3 text-sm font-bold text-slate-700 dark:text-slate-300 bg-slate-50 dark:bg-slate-900/50 px-6 py-3 rounded-full border border-slate-200 dark:border-slate-800 hover:border-blue-500 hover:bg-white dark:hover:bg-slate-800 hover:shadow-md transition-all group"
				>
					<svg
						class="w-5 h-5"
						viewBox="0 0 24 24"
						width="24"
						height="24"
						xmlns="http://www.w3.org/2000/svg"
					>
						<g transform="matrix(1, 0, 0, 1, 0, 0)">
							<path
								d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"
								fill="#4285F4"></path>
							<path
								d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"
								fill="#34A853"></path>
							<path
								d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"
								fill="#FBBC05"></path>
							<path
								d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"
								fill="#EA4335"></path>
						</g>
					</svg>
					<span>
						Add us as a <span
							class="text-blue-600 dark:text-blue-400 group-hover:underline"
							>preferred source</span
						> on Google
					</span>
				</a>
			</div>

			{/* CTA */}
			<div
				class="mt-20 p-8 md:p-12 bg-slate-900 rounded-3xl text-center relative overflow-hidden"
			>
				<div
					class="absolute top-0 right-0 w-64 h-64 bg-empower-pink/20 rounded-full blur-3xl -mr-16 -mt-16 pointer-events-none"
				>
				</div>
				<div
					class="absolute bottom-0 left-0 w-64 h-64 bg-purple-600/20 rounded-full blur-3xl -ml-16 -mb-16 pointer-events-none"
				>
				</div>

				<h3
					class="text-2xl md:text-3xl font-bold text-white mb-4 relative z-10"
				>
					Ready to build your Digital Engine?
				</h3>
				<p class="text-slate-400 mb-8 max-w-xl mx-auto relative z-10">
					Stop letting your website be a brochure. Let's turn it into
					a revenue-generating asset.
				</p>
				<a
					href="/contact"
					class="relative z-10 inline-block bg-white text-slate-900 font-bold py-4 px-8 rounded-xl hover:bg-empower-pink hover:text-white transition-all transform hover:-translate-y-1 shadow-lg"
				>
					Book a Strategy Call
				</a>
			</div>
		</article>
	</main>
</Layout>

<style is:global>
	/* Force dark mode text colors for insights content to override any prose defaults */
	.dark .prose p,
	.dark .prose li,
	.dark .prose ul,
	.dark .prose ol {
		color: #cbd5e1 !important; /* slate-300 */
	}
	.dark .prose strong,
	.dark .prose h1,
	.dark .prose h2,
	.dark .prose h3,
	.dark .prose h4 {
		color: #ffffff !important;
	}
</style>
