<!-- Modal Overlay -->
<dialog
    id="vibe-modal"
    class="bg-transparent p-0 backdrop:bg-black/80 w-full max-w-4xl m-auto rounded-3xl shadow-2xl open:animate-fade-in backdrop:open:animate-fade-in"
>
    <div
        class="bg-neutral-900 border border-neutral-800 text-white rounded-3xl overflow-hidden relative"
    >
        <button
            onclick="closeModal()"
            class="absolute top-6 right-6 z-50 p-2 bg-neutral-800 rounded-full hover:bg-neutral-700 transition-colors"
        >
            <X class="w-6 h-6" />
        </button>

        <div class="grid md:grid-cols-2 min-h-[500px]">
            <!-- Visual Side -->
            <div
                id="modal-visual"
                class="p-12 flex flex-col justify-between relative overflow-hidden bg-neutral-950"
            >
                <div class="absolute inset-0 opacity-20" id="modal-gradient">
                </div>
                <div class="relative z-10">
                    <h3 class="text-sm font-mono opacity-50 mb-2">VIBE DNA</h3>
                    <h2
                        id="modal-title"
                        class="text-5xl font-bold tracking-tighter mb-6"
                    >
                    </h2>
                    <p
                        id="modal-desc"
                        class="text-xl text-neutral-300 leading-relaxed"
                    >
                    </p>
                </div>

                <div class="relative z-10 mt-12">
                    <div class="flex gap-4">
                        <div
                            class="w-16 h-16 rounded-full border-2 border-white/10"
                            id="color-swatch-1"
                        >
                        </div>
                        <div
                            class="w-16 h-16 rounded-full border-2 border-white/10 opacity-60"
                            id="color-swatch-2"
                        >
                        </div>
                        <div
                            class="w-16 h-16 rounded-full border-2 border-white/10 opacity-30"
                            id="color-swatch-3"
                        >
                        </div>
                    </div>
                </div>
            </div>

            <!-- Details Side -->
            <div class="p-12 bg-neutral-900 flex flex-col justify-center">
                <div class="space-y-8">
                    <div>
                        <h4
                            class="text-sm font-bold text-neutral-500 mb-2 tracking-wider"
                        >
                            TYPOGRAPHY
                        </h4>
                        <div class="space-y-2">
                            <p class="text-3xl font-light">Aa Bb Cc</p>
                            <p class="text-sm text-neutral-400 font-mono">
                                Primary Header Font
                            </p>
                        </div>
                    </div>

                    <div class="w-full h-px bg-neutral-800"></div>

                    <div>
                        <h4
                            class="text-sm font-bold text-neutral-500 mb-2 tracking-wider"
                        >
                            UI ELEMENTS
                        </h4>
                        <div class="flex gap-4">
                            <button
                                class="px-6 py-2 rounded-lg bg-white text-black font-bold text-sm"
                                >Primary</button
                            >
                            <button
                                class="px-6 py-2 rounded-lg border border-white/20 text-white font-bold text-sm"
                                >Secondary</button
                            >
                        </div>
                    </div>

                    <div class="w-full h-px bg-neutral-800"></div>

                    <button
                        class="w-full py-4 bg-white text-black font-bold rounded-xl hover:bg-neutral-200 transition-colors"
                    >
                        Apply This Vibe
                    </button>
                </div>
            </div>
        </div>
    </div>
</dialog>

<script is:inline define:vars={{ vibes }}>
    const modal = document.getElementById("vibe-modal");
    const modalTitle = document.getElementById("modal-title");
    const modalDesc = document.getElementById("modal-desc");
    const modalVisual = document.getElementById("modal-visual");
    const modalGradient = document.getElementById("modal-gradient");
    const swatch1 = document.getElementById("color-swatch-1");
    const swatch2 = document.getElementById("color-swatch-2");
    const swatch3 = document.getElementById("color-swatch-3");

    window.openModal = (slug) => {
        const vibe = vibes.find((v) => v.slug === slug);
        if (!vibe) return;

        modalTitle.innerText = vibe.title;
        modalDesc.innerText = vibe.description;

        // Dynamic styling based on vibe
        swatch1.style.backgroundColor = vibe.hex;
        swatch2.style.backgroundColor = vibe.hex;
        swatch3.style.backgroundColor = vibe.hex;

        modalGradient.style.background = `radial-gradient(circle at top right, ${vibe.hex}, transparent)`;

        modal.showModal();
        document.body.style.overflow = "hidden";
    };

    window.closeModal = () => {
        modal.close();
        document.body.style.overflow = "";
    };

    modal.addEventListener("click", (e) => {
        const dialogDimensions = modal.getBoundingClientRect();
        if (
            e.clientX < dialogDimensions.left ||
            e.clientX > dialogDimensions.right ||
            e.clientY < dialogDimensions.top ||
            e.clientY > dialogDimensions.bottom
        ) {
            closeModal();
        }
    });
</script>

<style>
    dialog::backdrop {
        background: rgba(0, 0, 0, 0.8);
        backdrop-filter: blur(4px);
    }

    @keyframes fade-in {
        from {
            opacity: 0;
            transform: scale(0.95);
        }
        to {
            opacity: 1;
            transform: scale(1);
        }
    }

    .animate-fade-in {
        animation: fade-in 0.3s ease-out forwards;
    }
</style>
