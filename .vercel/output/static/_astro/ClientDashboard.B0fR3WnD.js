import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as o}from"./index.Cd_vQiNd.js";import{s as a}from"./supabase.L6wy3b_6.js";import{F as L}from"./file-text.C5K_yrNJ.js";import{C as u}from"./circle-check-big.D2RZclvb.js";import{c as x}from"./createLucideIcon.DV6VgPWa.js";/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],S=x("circle",A);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],E=x("download",B);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],q=x("folder",T);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],M=x("upload",z);function Y({demoMode:n=!1}){const[D,f]=o.useState(!n),[i,g]=o.useState(null),[c,d]=o.useState([]),[b,j]=o.useState([]),[m,N]=o.useState("overview"),[v,w]=o.useState(!1);o.useEffect(()=>{n?(g({id:"demo-123",name:"Demo Brand Redesign",status:"Active",progress:65}),d([{id:1,title:"Initial Consultation",is_completed:!0,type:"admin_task"},{id:2,title:"Brand Strategy Deck",is_completed:!0,type:"admin_task"},{id:3,title:"Logo Concepts",is_completed:!1,type:"admin_task"},{id:4,title:"Fill out Onboarding Form",is_completed:!0,type:"client_task"},{id:5,title:"Upload Brand Assets",is_completed:!1,type:"client_task"},{id:6,title:"Approve Moodboard",is_completed:!1,type:"client_task"}]),j([{id:1,name:"Contract_Signed.pdf",size:"1.2 MB",created_at:new Date().toISOString(),url:"#"},{id:2,name:"Brand_Guidelines_v1.pdf",size:"4.5 MB",created_at:new Date().toISOString(),url:"#"}]),f(!1)):h()},[n]);const h=async()=>{const{data:{session:t}}=await a.auth.getSession();if(!t){window.location.href="/portal";return}const{data:s}=await a.from("projects").select("*").eq("client_id",t.user.id).limit(1);if(s&&s.length>0){const r=s[0];g(r);const{data:l}=await a.from("tasks").select("*").eq("project_id",r.id).order("created_at",{ascending:!0});d(l||[]);const{data:p}=await a.from("documents").select("*").eq("project_id",r.id).order("created_at",{ascending:!1});j(p||[])}f(!1)},_=async()=>{if(n){alert("This is just a demo! In the real portal, this logs you out.");return}await a.auth.signOut(),window.location.href="/portal"},$=async t=>{if(n){alert("File upload is disabled in demo mode.");return}const s=t.target.files[0];if(!(!s||!i)){w(!0);try{const r=s.name.split(".").pop(),l=`${Math.random()}.${r}`,p=`${i.id}/${l}`,{error:C}=await a.storage.from("portal-files").upload(p,s);if(C)throw C;const{data:{publicUrl:U}}=a.storage.from("portal-files").getPublicUrl(p),{error:F}=await a.from("documents").insert({project_id:i.id,name:s.name,url:U,size:(s.size/1024/1024).toFixed(2)+" MB",uploaded_by:(await a.auth.getUser()).data.user.id});if(F)throw F;await a.from("activity_logs").insert({project_id:i.id,message:`Client uploaded file: ${s.name}`}),alert("File uploaded successfully!"),h()}catch(r){alert("Error uploading file: "+r.message)}finally{w(!1)}}},P=async(t,s)=>{if(n){d(c.map(l=>l.id===t?{...l,is_completed:!s}:l));return}d(c.map(l=>l.id===t?{...l,is_completed:!s}:l));const{error:r}=await a.from("tasks").update({is_completed:!s}).eq("id",t);r?(alert("Error updating task"),h()):s||await a.from("activity_logs").insert({project_id:i.id,message:"Client completed task."})};if(D)return e.jsx("div",{className:"min-h-screen bg-slate-950 flex items-center justify-center text-white",children:"Loading Project..."});if(!i)return e.jsxs("div",{className:"min-h-screen bg-slate-950 flex items-center justify-center text-white flex-col gap-4",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"No Active Project Found"}),e.jsx("p",{className:"text-slate-400",children:"Please contact Nicola to initialize your project."}),e.jsx("button",{onClick:_,className:"text-purple-400 hover:text-purple-300",children:"Logout"})]});const y=c.filter(t=>t.type==="admin_task"),k=c.filter(t=>t.type==="client_task");return e.jsx("div",{className:"min-h-screen bg-slate-950 pt-12 px-6 pb-12",children:e.jsxs("div",{className:"container mx-auto max-w-6xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:i.name}),e.jsxs("p",{className:"text-slate-400 mt-2",children:["Status: ",e.jsx("span",{className:"text-empower-pink font-bold",children:i.status})]})]}),e.jsx("button",{onClick:_,className:"text-slate-400 hover:text-white transition-colors",children:"Logout"})]}),e.jsxs("div",{className:"flex gap-8 border-b border-slate-800 mb-8",children:[e.jsx("button",{onClick:()=>N("overview"),className:`pb-4 text-sm font-bold uppercase tracking-wider transition-colors ${m==="overview"?"text-empower-pink border-b-2 border-empower-pink":"text-slate-500 hover:text-slate-300"}`,children:"Overview"}),e.jsx("button",{onClick:()=>N("documents"),className:`pb-4 text-sm font-bold uppercase tracking-wider transition-colors ${m==="documents"?"text-empower-pink border-b-2 border-empower-pink":"text-slate-500 hover:text-slate-300"}`,children:"File Centre"})]}),m==="overview"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-slate-900 p-8 rounded-2xl border border-slate-800",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-amber-500/10 rounded-lg text-amber-500",children:e.jsx(L,{className:"w-5 h-5"})}),e.jsx("h2",{className:"text-xl font-bold text-white",children:"My Action Plan"})]}),e.jsxs("div",{className:"space-y-4",children:[y.map(t=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-slate-950/50 rounded-lg border border-slate-800/50",children:[t.is_completed?e.jsx(u,{className:"w-5 h-5 text-emerald-500 shrink-0"}):e.jsx(S,{className:"w-5 h-5 text-slate-600 shrink-0"}),e.jsx("span",{className:`text-sm ${t.is_completed?"text-slate-500 line-through":"text-slate-300"}`,children:t.title})]},t.id)),y.length===0&&e.jsx("p",{className:"text-slate-500 italic",children:"No actions listed yet."})]})]}),e.jsxs("div",{className:"bg-slate-900 p-8 rounded-2xl border border-slate-800",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-purple-500/10 rounded-lg text-purple-500",children:e.jsx(u,{className:"w-5 h-5"})}),e.jsx("h2",{className:"text-xl font-bold text-white",children:"Your Tasks"})]}),e.jsxs("div",{className:"space-y-4",children:[k.map(t=>e.jsxs("div",{onClick:()=>P(t.id,t.is_completed),className:"flex items-start gap-3 p-3 bg-slate-950/50 rounded-lg border border-slate-800/50 cursor-pointer hover:border-purple-500/50 transition-colors",children:[t.is_completed?e.jsx(u,{className:"w-5 h-5 text-emerald-500 shrink-0"}):e.jsx(S,{className:"w-5 h-5 text-purple-500 shrink-0"}),e.jsx("span",{className:`text-sm ${t.is_completed?"text-slate-500 line-through":"text-white"}`,children:t.title})]},t.id)),k.length===0&&e.jsx("p",{className:"text-slate-500 italic",children:"No tasks assigned to you."})]})]})]}),m==="documents"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-slate-900 p-8 rounded-2xl border border-slate-800",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-6",children:"Upload Files"}),e.jsxs("div",{className:"border-2 border-dashed border-slate-700 rounded-xl p-8 text-center hover:border-purple-500 transition-colors relative",children:[e.jsx("input",{type:"file",onChange:$,disabled:v,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"}),e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"p-4 bg-slate-800 rounded-full",children:e.jsx(M,{className:"w-8 h-8 text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium mb-1",children:v?"Uploading...":"Click or Drag to Upload"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"Support for images, PDF, and docs"})]})]})]})]}),e.jsxs("div",{className:"bg-slate-900 p-8 rounded-2xl border border-slate-800",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-6",children:"Shared Files"}),e.jsxs("div",{className:"space-y-3",children:[b.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-950/50 rounded-xl border border-slate-800 hover:border-slate-700 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500/10 rounded-lg text-blue-400",children:e.jsx(q,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium text-sm",children:t.name}),e.jsxs("p",{className:"text-xs text-slate-500",children:[t.size," â€¢ ",new Date(t.created_at).toLocaleDateString()]})]})]}),e.jsx("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"p-2 hover:bg-slate-800 rounded-lg text-slate-400 hover:text-white transition-colors",children:e.jsx(E,{className:"w-4 h-4"})})]},t.id)),b.length===0&&e.jsx("p",{className:"text-slate-500 italic",children:"No documents shared yet."})]})]})]})]})})}export{Y as default};
